<ejs-grid id="Grid" dataSource="@ViewBag.data" frozenColumns="1" allowPaging="true" toolbar="@( new List<object>() {"Add","Edit","Delete","Update","Cancel"})" recordDoubleClick="click" actionComplete="actionComplete" actionBegin="actionBegin">
    <e-grid-editsettings allowAdding="true" allowDeleting="true" allowEditing="true"></e-grid-editsettings>
    <e-grid-pageSettings pageCount="5" pageSize="5"></e-grid-pageSettings>
    <e-grid-columns>
      <e-grid-column field="OrderID" headerText="Order ID" isPrimaryKey="true" textAlign="Right" width="300"></e-grid-column>
      <e-grid-column field="CustomerID" headerText="Customer ID" textAlign="Right" width="300"></e-grid-column>
      <e-grid-column field="ShipID" headerText="Ship ID" textAlign="Right" width="320"></e-grid-column>
      <e-grid-column field="City" headerText="City" textAlign="Right" width="300"></e-grid-column>
      <e-grid-column field="Freight" validationRules="@(new { required=true})" headerText="Freight" width="300" type="number" format="C2"></e-grid-column>
      <e-grid-column field="EmployeeID" headerText="Employee ID" textAlign="Right" width="300"></e-grid-column>
    </e-grid-columns>
</ejs-grid>

<script>
  var cellIndex;
  var scrollPos;
    function click(args) {
        cellIndex = args.cellIndex;
    }

  function actionComplete(args) {
    if (args.requestType == 'beginEdit') {
      var fieldToFocus = '#' + this.element.id + this.columns[cellIndex].field;
      var cellSelected = args.movableForm.querySelector(fieldToFocus);
      cellSelected.focus();
      this.scrollModule.content.querySelector('.e-movablecontent').scrollLeft = scrollPos;
    } else if (args.requestType == 'save' || args.requestType == 'cancel') {
      this.scrollModule.content.querySelector('.e-movablecontent').scrollLeft = scrollPos;
    }
  }

  function actionBegin(args) {
    if (args.requestType == 'beginEdit') {
    }
  }
  
</script>
